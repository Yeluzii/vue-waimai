{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-062a83b7\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"create-order\"\n};\nconst _hoisted_2 = {\n  class: \"content\"\n};\nconst _hoisted_3 = {\n  class: \"pay-wrap\"\n};\nconst _hoisted_4 = {\n  class: \"price\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"商品金额\", -1 /* HOISTED */));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Header = _resolveComponent(\"Header\");\n  const _component_van_contact_card = _resolveComponent(\"van-contact-card\");\n  const _component_van_card = _resolveComponent(\"van-card\");\n  const _component_van_button = _resolveComponent(\"van-button\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_Header, {\n    title: \"生成订单\"\n  }), _createVNode(_component_van_contact_card, {\n    type: \"edit\",\n    tel: _ctx.tel,\n    name: _ctx.name,\n    onClick: $setup.onEdit\n  }, null, 8 /* PROPS */, [\"tel\", \"name\", \"onClick\"]), _createElementVNode(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.store.state.orderList, (item, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index\n    }, [_createVNode(_component_van_card, {\n      num: item.num,\n      price: item.price,\n      title: item.title,\n      thumb: item.pic\n    }, null, 8 /* PROPS */, [\"num\", \"price\", \"title\", \"thumb\"])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _createElementVNode(\"span\", null, \"￥\" + _toDisplayString(_ctx.totalPrice), 1 /* TEXT */)]), _createVNode(_component_van_button, {\n    type: \"primary\",\n    class: \"pay-btn\",\n    block: \"\",\n    color: \"#ffc400\",\n    onClick: $setup.handleCreateOrder\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"生成订单\")]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_Header","title","_component_van_contact_card","type","tel","_ctx","name","onClick","$setup","onEdit","_hoisted_2","_Fragment","_renderList","store","state","orderList","item","index","key","_component_van_card","num","price","thumb","pic","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","totalPrice","_component_van_button","block","color","handleCreateOrder"],"sources":["D:\\vue3-projects\\vue-waimai\\src\\views\\createOrder\\CreateOrderIndex.vue"],"sourcesContent":["<template>\r\n    <div class=\"create-order\">\r\n        <Header title=\"生成订单\" />\r\n        <van-contact-card type=\"edit\" :tel=\"tel\" :name=\"name\" @click=\"onEdit\" />\r\n        <div class=\"content\">\r\n            <div v-for=\"(item, index) in store.state.orderList\" :key=\"index\">\r\n                <van-card :num=\"item.num\" :price=\"item.price\" :title=\"item.title\" :thumb=\"item.pic\" />\r\n            </div>\r\n        </div>\r\n        <div class=\"pay-wrap\">\r\n            <div class=\"price\">\r\n                <span>商品金额</span>\r\n                <span>￥{{ totalPrice }}</span>\r\n            </div>\r\n            <van-button type=\"primary\" class=\"pay-btn\" block color=\"#ffc400\"\r\n                @click=\"handleCreateOrder\">生成订单</van-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport Header from '../../components/HeaderOf1.vue';\r\nimport { reactive, toRefs, onMounted } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter, useRoute } from 'vue-router';\r\nimport { Dialog } from 'vant';\r\n\r\nexport default {\r\n    components: {\r\n        Header,\r\n    },\r\n    setup() {\r\n        const data = reactive({\r\n            tel: '1234567890X',\r\n            name: 'Yeluzi',\r\n            totalPrice: 0\r\n        });\r\n        const store = useStore();\r\n        const router = useRouter();\r\n        const route = useRoute();\r\n        const onEdit = () => { }\r\n        const initPrice = () => {\r\n            let price = 0;\r\n            if (store.state.orderList.length) {\r\n                store.state.orderList.forEach((item) => {\r\n                    price += item.price * item.num;\r\n                });\r\n            }\r\n            data.totalPrice = price;\r\n        };\r\n        // 初始化用户的地址\r\n        const initUser = () => {\r\n            store.state.userAddress.forEach((item) => {\r\n                if (item.isDefault) {\r\n                    data.name = item.name;\r\n                    data.tel = item.tel;\r\n                }\r\n            });\r\n        };\r\n        const handleCreateOrder = () => {\r\n            Dialog({\r\n                title: '提示',\r\n                message: '生成订单成功！',\r\n            }).then(() => {\r\n                // console.log(route.query.list);\r\n                // 要和购物车联系起来,过滤\r\n                let newList = store.state.cartList.filter((item) => {\r\n                    return !route.query.list.includes(item.id + \"\");\r\n                });\r\n                store.commit('delete', newList);\r\n                router.push(\"/order\");\r\n            });\r\n        }\r\n\r\n        // const handleCreateOrder = () => {\r\n        //     Dialog({\r\n        //         title: '提示',\r\n        //         message: '生成订单成功！',\r\n        //     }).then(() => {\r\n        //         // 要和购物车联系起来,过滤\r\n        //         // 确保 route.query.list 是一个数组\r\n        //         const listIds = route.query.list ? (Array.isArray(route.query.list) ? route.query.list : route.query.list.split(',')) : [];\r\n\r\n        //         let newList = store.state.cartList.filter((item) => {\r\n        //             // 确保 item.id 被转换为字符串\r\n        //             return !listIds.includes(item.id + \"\");\r\n        //         });\r\n\r\n        //         store.commit('delete', newList);\r\n        //         router.push(\"/order\");\r\n        //     });\r\n        // };\r\n\r\n        onMounted(() => {\r\n            initPrice();\r\n            initUser();\r\n        });\r\n        return {\r\n            ...toRefs(data),\r\n            onEdit,\r\n            store,\r\n            handleCreateOrder\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.create-order {\r\n    display: flex;\r\n    flex-flow: column;\r\n    height: 100%;\r\n\r\n    .content {\r\n        flex: 1;\r\n        overflow-y: auto;\r\n    }\r\n\r\n    .pay-wrap {\r\n        padding: 10px 0;\r\n        width: 100%;\r\n        background: #fff;\r\n        border-top: 1px solid #e9e9e9;\r\n\r\n        >div {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            padding: 0 5%;\r\n            margin: 10px 0;\r\n            font-size: 14px;\r\n\r\n            span:nth-child(2) {\r\n                color: red;\r\n                font-size: 18px;\r\n            }\r\n        }\r\n\r\n        .pay-btn {\r\n            width: 90%;\r\n            margin: 0 auto;\r\n        }\r\n    }\r\n}\r\n</style>"],"mappings":";;;EACSA,KAAK,EAAC;AAAc;;EAGhBA,KAAK,EAAC;AAAS;;EAKfA,KAAK,EAAC;AAAU;;EACZA,KAAK,EAAC;AAAO;gEACdC,mBAAA,CAAiB,cAAX,MAAI;;;;;;uBAVtBC,mBAAA,CAgBM,OAhBNC,UAgBM,GAfFC,YAAA,CAAuBC,iBAAA;IAAfC,KAAK,EAAC;EAAM,IACpBF,YAAA,CAAwEG,2BAAA;IAAtDC,IAAI,EAAC,MAAM;IAAEC,GAAG,EAAEC,IAAA,CAAAD,GAAG;IAAGE,IAAI,EAAED,IAAA,CAAAC,IAAI;IAAGC,OAAK,EAAEC,MAAA,CAAAC;uDAC9Db,mBAAA,CAIM,OAJNc,UAIM,I,kBAHFb,mBAAA,CAEMc,SAAA,QAAAC,WAAA,CAFuBJ,MAAA,CAAAK,KAAK,CAACC,KAAK,CAACC,SAAS,GAArCC,IAAI,EAAEC,KAAK;yBAAxBpB,mBAAA,CAEM;MAF+CqB,GAAG,EAAED;IAAK,IAC3DlB,YAAA,CAAsFoB,mBAAA;MAA3EC,GAAG,EAAEJ,IAAI,CAACI,GAAG;MAAGC,KAAK,EAAEL,IAAI,CAACK,KAAK;MAAGpB,KAAK,EAAEe,IAAI,CAACf,KAAK;MAAGqB,KAAK,EAAEN,IAAI,CAACO;;oCAGvF3B,mBAAA,CAOM,OAPN4B,UAOM,GANF5B,mBAAA,CAGM,OAHN6B,UAGM,GAFFC,UAAiB,EACjB9B,mBAAA,CAA8B,cAAxB,GAAC,GAAA+B,gBAAA,CAAGtB,IAAA,CAAAuB,UAAU,iB,GAExB7B,YAAA,CACgD8B,qBAAA;IADpC1B,IAAI,EAAC,SAAS;IAACR,KAAK,EAAC,SAAS;IAACmC,KAAK,EAAL,EAAK;IAACC,KAAK,EAAC,SAAS;IAC3DxB,OAAK,EAAEC,MAAA,CAAAwB;;sBAAmB,MAAI,C,iBAAJ,MAAI,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}