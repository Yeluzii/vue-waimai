{"ast":null,"code":"import { reactive, toRefs, onMounted, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport ListItem from '../../../components/ListItem.vue';\nimport { Toast } from 'vant';\nexport default {\n  components: {\n    ListItem\n  },\n  setup() {\n    const store = useStore();\n    const data = reactive({\n      checked: [],\n      submitChecked: true\n    });\n    const handleChange = (value, detail) => {\n      store.state.cartList.map(item => {\n        if (item.id === detail.name) {\n          item.num = value;\n        }\n      });\n    };\n    const init = () => {\n      data.checked = store.state.cartList.map(item => item.id);\n    };\n    onMounted(() => {\n      init();\n    });\n    const onSubmit = () => {};\n    const chooseAll = () => {\n      if (data.checked.length !== store.state.cartList.length) {\n        init();\n      } else {\n        data.checked = [];\n      }\n    };\n    const groupChange = result => {\n      if (result.length === store.state.cartList.length) {\n        data.submitChecked = true;\n      } else {\n        data.submitChecked = false;\n      }\n      data.checked = result;\n    };\n    const allPrice = computed(() => {\n      let countList = store.state.cartList.filter(item => {\n        return data.checked.includes(item.id);\n      });\n      let sum = 0;\n      countList.forEach(item => {\n        sum += item.price * item.num;\n      });\n      return sum * 100;\n    });\n    const handleDelete = () => {\n      // 判断data的checked是否有值\n      if (data.checked.length) {\n        store.state.cartList = store.state.cartList.filter(item => {\n          return !data.checked.includes(item.id);\n        });\n        data.checked = [];\n      } else {\n        Toast('请先选择要删除的商品');\n      }\n    };\n    return {\n      ...toRefs(data),\n      store,\n      handleChange,\n      onSubmit,\n      chooseAll,\n      groupChange,\n      allPrice,\n      handleDelete\n    };\n  }\n};","map":{"version":3,"names":["reactive","toRefs","onMounted","computed","useStore","ListItem","Toast","components","setup","store","data","checked","submitChecked","handleChange","value","detail","state","cartList","map","item","id","name","num","init","onSubmit","chooseAll","length","groupChange","result","allPrice","countList","filter","includes","sum","forEach","price","handleDelete"],"sources":["D:\\vue3-projects\\vue-waimai\\src\\views\\cart\\components\\CartDetail.vue"],"sourcesContent":["<template>\r\n    <div class=\"cartDetail\">\r\n        <div class=\"content\">\r\n            <van-checkbox-group v-model=\"checked\" @change=\"groupChange\">\r\n                <div v-for=\"(item, index) in store.state.cartList\" :key=\"index\">\r\n                    <ListItem :item=\"item\" :handleChange=\"handleChange\" :showCheckBox=\"true\" />\r\n                </div>\r\n            </van-checkbox-group>\r\n        </div>\r\n        <van-submit-bar :price=\"allPrice\" button-text=\"结算\" @submit=\"onSubmit\" class=\"submit-all\" button-color=\"#ffc400\"\r\n            v-if=\"store.state.isDelete\">\r\n            <van-checkbox v-model=\"submitChecked\" checked-color=\"#ffc400\" @click=\"chooseAll\">全选</van-checkbox>\r\n        </van-submit-bar>\r\n        <div class=\"buy\" v-else>\r\n            <div class=\"left\">\r\n                <van-checkbox v-model=\"submitChecked\" checked-color=\"#ffc400\" @click=\"chooseAll\">全选</van-checkbox>\r\n            </div>\r\n            <div class=\"delete\" @click=\"handleDelete\">删除</div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { reactive, toRefs, onMounted, computed } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport ListItem from '../../../components/ListItem.vue';\r\nimport { Toast } from 'vant'\r\nexport default {\r\n    components: {\r\n        ListItem\r\n    },\r\n    setup() {\r\n        const store = useStore();\r\n        const data = reactive({\r\n            checked: [],\r\n            submitChecked: true,\r\n        });\r\n        const handleChange = (value, detail) => {\r\n            store.state.cartList.map((item) => {\r\n                if (item.id === detail.name) {\r\n                    item.num = value;\r\n                }\r\n            })\r\n        };\r\n\r\n        const init = () => {\r\n            data.checked = store.state.cartList.map((item) => item.id);\r\n        };\r\n\r\n        onMounted(() => {\r\n            init();\r\n        });\r\n        const onSubmit = () => { };\r\n        const chooseAll = () => {\r\n            if (data.checked.length !== store.state.cartList.length) {\r\n                init();\r\n            } else {\r\n                data.checked = [];\r\n            }\r\n        };\r\n        const groupChange = (result) => {\r\n            if (result.length === store.state.cartList.length) {\r\n                data.submitChecked = true;\r\n            } else {\r\n                data.submitChecked = false;\r\n            }\r\n            data.checked = result;\r\n        };\r\n        const allPrice = computed(() => {\r\n            let countList = store.state.cartList.filter((item) => {\r\n                return data.checked.includes(item.id);\r\n            });\r\n            let sum = 0;\r\n            countList.forEach((item) => {\r\n                sum += item.price * item.num;\r\n            });\r\n            return sum * 100;\r\n        });\r\n        const handleDelete = () => {\r\n            // 判断data的checked是否有值\r\n            if (data.checked.length) {\r\n                store.state.cartList = store.state.cartList.filter((item) => {\r\n                    return !data.checked.includes(item.id);\r\n                });\r\n                data.checked = [];\r\n            } else {\r\n                Toast('请先选择要删除的商品');\r\n            }\r\n        }\r\n\r\n        return {\r\n            ...toRefs(data),\r\n            store,\r\n            handleChange,\r\n            onSubmit,\r\n            chooseAll,\r\n            groupChange,\r\n            allPrice,\r\n            handleDelete\r\n        };\r\n    },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.cartDetail {\r\n    font-size: 14px;\r\n    flex: 1;\r\n    position: relative;\r\n    overflow-y: auto;\r\n    padding: 20px 20px 55px;\r\n\r\n    .submit-all {\r\n        position: fixed;\r\n        bottom: 46px;\r\n    }\r\n\r\n    .buy {\r\n        position: fixed;\r\n        bottom: 48px;\r\n        right: 0;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        width: 100%;\r\n        background-color: #fff;\r\n        border-radius: 10px;\r\n        height: 50px;\r\n        align-items: center;\r\n        padding: 0 16px;\r\n        box-sizing: border-box;\r\n\r\n        .left {\r\n            display: flex;\r\n            align-items: center;\r\n        }\r\n\r\n        .delete {\r\n            color: #fff;\r\n            background-color: #ffc400;\r\n            border-radius: 20px;\r\n            font-size: 14px;\r\n            font-weight: 600;\r\n            width: 110px;\r\n            height: 40px;\r\n            text-align: center;\r\n            line-height: 40px;\r\n        }\r\n    }\r\n\r\n    .content {\r\n        padding: 10px;\r\n        background-color: #fff;\r\n        border-radius: 10px;\r\n    }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}